@model IEnumerable<PROG_MVC_POE_P2.Models.Claim>

@{
    ViewData["Title"] = "Submitted Payment Claims";
}

<div class="text-center">
    <h1>Submitted Payment Claims</h1>

    <p>
        <a asp-action="Create" class="btn btn-primary">Submit New Claim</a> |
        <a asp-action="Index" asp-controller="Home" class="btn btn-secondary">Back to Home</a>
    </p>

    <table class="table table-bordered">
        <thead>
            <tr>
                <th>Lecturer ID</th>
                <th>Claim Time</th>
                <th>Status</th>      
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            @if (Model != null && Model.Any())
            {
                foreach (var item in Model.OrderByDescending(c => c.ClaimTime))
                {
                        //====================declare variables==============================
                        string statusClass = item.Status == "Approved" ? "table-success" :
                                             item.Status == "Rejected" ? "table-danger" :
                                             "table-warning";
                        
                        string badgeClass = item.Status == "Approved" ? "bg-success" :
                                            item.Status == "Rejected" ? "bg-danger" :
                                            "bg-warning";
                        //====================================================================

                    <tr class="@statusClass">
                        <td>@item.LecturerId</td>
                        <td>@item.ClaimTime.ToString("yyyy-MM-dd HH:mm")</td>
                        <td>
                            <span class="badge @badgeClass">
                                @item.Status
                            </span>
                        </td>
                        <td>
                            @*only edit if the status is pending*@
                            @if (item.Status == "Pending")
                            {
                                <a asp-action="Edit" class="btn btn-secondary" asp-route-id="@item.ClaimId">Edit</a> 
                                
                            }
                            else
                            {
                                <span class="text-muted">No Edits</span>
                            }

                            <a asp-action="Details" class="btn btn-secondary" asp-route-id="@item.ClaimId">Details</a>
                            <a asp-action="Delete" class="btn btn-danger" asp-route-id="@item.ClaimId">Delete</a>

                        </td>
                    </tr>
                }
            }
            else
            {
                <tr><td colspan="4">No claims found.</td></tr>
            }
        </tbody>
    </table>

</div>